{% extends "layout.html" %}

{% block extraHead %}
<script type="text/javascript">
        function getId(el) {
                var id = el.id;
                console.log(el.name);
                if(el.name != 0){
                        // dataJson = {'id':data}
                        // alert(dataJson.id);
                        console.log(id);
                        $.ajax({
                                url: '/buyProduct?id=' + id,//自己的服务接口地址
                                type: 'POST',
                                success: function (data) {
                                        if($('#login').val('Login'))
                                        {
                                                redirectLogin();
                                        }
                                        else{
                                                redirect();
                                        }
                                        
                                        // location.replace("localhost:5000/buy");

                                },
                                error: function () {
                                        redirectLogin();
                                },

                        });
                }else{
                        alert("this item is solt out !");
                }

        }

        function redirect() {
                window.location.href = "http://127.0.0.1:5000/buyPage";
        }
        function redirectLogin() {
                window.location.href = "http://127.0.0.1:5000/login";
        }

</script>

{% endblock %}


{% block mainBody %}
<div class="bar" style="padding-top: 0px;">
        <div class="nav">
                <ul class="pc-nav" style="background-image:url(static/images/ic_down_nor.png);">
                        <li><a href="/guys">Guys</a></li>
                        <li><a href="/girls">Girls</a></li>
                        <li><a href="/kids">Kids</a></li>
                        <li>Sales</li>
                        <input type="text" placeholder="Lowest" class="scope" style="z-index: 1;float:left">
                        <img src="{{url_for("static", filename="images/ic_Swap.png")}}" />
                        <input type="text" placeholder="Highest" class="scope">
                        <input type="button" class="confirm" style="background-image: url(static/images/ic_down_pre.png);"
                                value="Confirm" id="queren">
                                <input type="button" class="confirm" style="background-image: url(static/images/ic_down_pre.png);" value='Login' onclick="window.location.href='/login'">
                        <input type="button" class="confirm" style="background-image: url(static/images/ic_down_pre.png);"
                                value="Register" onclick="window.location.href='/register'">
                        <input type="button" class="confirm" style="background-image: url(static/images/ic_down_pre.png);"
                                value="Add Product" onclick="window.location.href='/addProduct'">
                </ul>
        </div>
</div>
<div id="productList">
        <ul style="list-style: none;">
                {% for item in products %}
                <li id="itemLi">
                        <p>
                                <img width="200" height="200" src={{item['photo']}} onclick="getId(this)" id={{item['id']}} name={{item['stocks']}}>>
                                <br />
                                <span style="color:red;font-size:1.1em;">&#8364;{{item['price']}}</span>
                                <br />
                                {{ item['name'] }}
                                <br />
                                stocks: {{ item['stocks'] }}
                                <br />
                                {{ item['type'] }}
                        </p>

                </li>
                {% endfor %}
        </ul>
</div>
{% endblock %}